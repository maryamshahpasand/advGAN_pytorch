import matplotlib.pyplot as plt
from sklearn import preprocessing
import pandas as pd



fig, (ax1, ax2) = plt.subplots(1, 2)
plt.figure(figsize=(20,10))
rounds = list(range(0, 20))




maljsma=[	99.3,	97.016129032258,	90.8746276739778,	81.8941504178272,	71.6787103946637,	69.0831556503198,	39.2119565217391,	7.5183719615602,	2.28878214184797,	0.310383747178329,	0.0846501128668171,None,None,None,None,None,None,None,None,None]#,	0,	0,	0,	0,	0,	0,	0,	0,	0]
malfgsm=[	94.29,	86.37463048,	35.09105735,	4.682274247,	0.116788321,	0.087642419,None,None,None,None,None,None,None,None,None,None,None,None,None,None]#,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0]
malgan=[	100,	100,	99.5654873,	99.1266376,	99.8736576,	98.4790875,	96.6349206,	93.316359,	96.5762274,	93.8422065,	94.3359375,	97.3924381,	87.8289474,	88.5245902,	80.6232811,	67.4590749,	51.6811398,	47.2483686,	21.9181689,	15.8329111]
optmalgan=[	100,	98.02648663,	94.43001818,	83.71591794,	93.02345711,	89.71046481,	87.49242621,	86.76707349,	84.79182896,	80.5959491,	76.79390634,	63.98338094,	52.73695144,	57.88972561,	54.1331256,	54.76508266,	53.55751753,	47.77979746,	40.1843677,	40.0017546]
# "Retraining Rounds":rounds,
df = pd.DataFrame({ "MalJSMA": maljsma, "MalFGSM": malfgsm, "MalGAN": malgan, "OptMalGAN": optmalgan})
df.plot(kind="line",linewidth=0.7,style=[':', '-', '-.', '--'],markersize=3,
                          ax=ax1,
                          legend=False)

maljsma=[	99.05601007,	99.49141767,	99.80842912,	92.90826285,	99.93585632,	96.34703196,	54.76963011,	28.18181818,	25.13020833,	15.41450777,	94.3359375,	97.3924381,	87.8289474,	88.5245902,	80.6232811,	67.4590749,	51.6811398,	47.2483686,	21.9181689,	15.8329111]
malfgsm=[	94.29,	85.21303258,	78.55591748,	78.19216182,	6.065959953,	7.297297297,	0.176366843,	0.134770889,	0.117474302,	0.134770889,	0.088183422,	0.134861767,	0.146842878,	0.134589502,	0.440658049,	0.337154417,	0.146842878,	0.134770889,	0.058754407,	0.058754407]
malgan=[	100,	100,	99.5654873,	99.1266376,	99.8736576,	98.4790875,	96.6349206,	93.316359,	96.5762274,	93.8422065,	94.3359375,	97.3924381,	87.8289474,	88.5245902,	80.6232811,	67.4590749,	51.6811398,	47.2483686,	21.9181689,	15.8329111]
optmalgan=[	100,	98.02648663,	94.43001818,	83.71591794,	93.02345711,	89.71046481,	87.49242621,	86.76707349,	84.79182896,	80.5959491,	76.79390634,	63.98338094,	52.73695144,	57.88972561,	54.1331256,	54.76508266,	53.55751753,	47.77979746,	40.1843677,	40.0017546]

ax2.plot(range(len(maljsma)), maljsma, '-s', label='maljsma', markersize=3)
ax2.plot(range(len(maljsma)), malfgsm, '-r', label='malfgsm', markersize=3)
ax2.plot(range(len(maljsma)), malgan, '-b', label='malgan', markersize=3)
ax2.plot(range(len(maljsma)), optmalgan, '-g', label='optmalgan', markersize=3)

plt.savefig('./retraining.png')
#
plt.show()